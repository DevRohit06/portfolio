---
import Layout from "../layouts/Layout.astro";
import { socials } from "../lib/socials";
import Badge from "../components/Badge.astro";
import ThemeChanger from "../components/svelte/ThemeChanger.svelte";
import { Image } from "astro:assets";
import Pfp from "../assets/rohit.webp";
import DiscordActivity from "../components/DiscordActivity.astro";
import Mail from "../components/icons/Mail.astro";
import Discord from "../components/icons/Discord.astro";
import Instagram from "../components/icons/Instagram.astro";
import Twitter from "../components/icons/Twitter.astro";
import LinkedIn from "../components/icons/LinkedIn.astro";
import GitHub from "../components/icons/GitHub.astro";
import Favicon from "../components/icons/Favicon.astro";
import SocialIcons from "../components/SocialIcons.astro";
import { PUBLIC_DIALOGH_URL } from "astro:env/client";

const dialoghUrl = PUBLIC_DIALOGH_URL;

// Set canonical URL without trailing slash
const canonicalURL = new URL("/socials", Astro.site || Astro.url.origin).href;
const pageUrl = Astro.site ? new URL("/socials", Astro.site).href : "/socials";
---

<Layout title="Socials | Rohit Kushwaha" canonicalURL={canonicalURL}>
  <div class="page-content relative z-0">
    <!-- Main Container -->
    <div
      class="w-[95%] xs:w-[90%] sm:w-[85%] md:w-[80%] lg:w-[60%] xl:w-[50%] 2xl:w-[45%] relative z-20 mx-auto mt-8 mb-16"
    >
      <!-- Banner Section -->
      <div
        class="banner-section border border-[var(--border-color)] relative overflow-hidden"
      >
        <div
          class="size-4 bg-[var(--border-color)] absolute -top-2 -left-2 z-10"
        >
        </div>

        <img src={socials.banner} alt="Banner" class="w-full object-center" />
      </div>

      <!-- Profile Section -->
      <div
        class="profile-section border border-[var(--border-color)] border-t-0 p-6 sm:p-8 relative"
      >
        <!-- Profile Image (overlapping banner) -->
        <div class="profile-avatar-wrapper absolute -top-16">
          <div
            class="profile-avatar w-[100px] h-[100px] sm:w-[120px] sm:h-[120px] overflow-hidden"
          >
            <Image
              src={Astro.url.origin + "/android-chrome-512x512.png"}
              width={512}
              height={512}
              alt="Rohit Kushwaha"
              class="w-full h-full object-cover grayscale hover:grayscale-0"
            />
          </div>
        </div>

        <!-- Profile Info -->
        <div class="pt-8 sm:pt-10">
          <h1
            class="text-2xl sm:text-3xl font-semibold text-[var(--text-primary)]"
          >
            Rohit Kushwaha
          </h1>
          <p class="text-[var(--text-secondary)] text-sm sm:text-base mt-1">
            Vibe Engineer
          </p>

          <!-- Quick Social Icons -->
          <div class="flex justify-start mt-4">
            <SocialIcons size="md" />
          </div>
        </div>
      </div>

      <!-- Discord Status Section -->
      <div
        class="discord-section border border-[var(--border-color)] border-t-0 p-4 sm:p-6"
      >
        <Badge size="xs" className="mb-3">
          <span class="whitespace-nowrap text-xs uppercase">Discord Status</span
          >
        </Badge>
        <DiscordActivity showButtons={true} showAllActivities={true} />
      </div>

      <!-- Portfolio Links Section -->
      <div
        class="links-section border border-[var(--border-color)] border-t-0 p-4 sm:p-6"
      >
        <div class="flex items-center gap-3 mb-4">
          <Badge size="xs">
            <span class="whitespace-nowrap text-xs uppercase">Portfolio</span>
          </Badge>
          <div class="flex-1 h-px bg-[var(--border-color)]"></div>
        </div>

        <div class="flex flex-col gap-3">
          <a href="/" target="_blank" class="link-button group">
            <span class="link-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
              </svg>
            </span>
            <span class="link-text">Portfolio Website</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a href="/blogs" target="_blank" class="link-button group">
            <span class="link-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
              </svg>
            </span>
            <span class="link-text">Read My Blog</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a href="/projects" target="_blank" class="link-button group">
            <span class="link-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"
                ></path>
              </svg>
            </span>
            <span class="link-text">View Projects</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href={socials.resume}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                ></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </span>
            <span class="link-text">Download Resume</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>
        </div>
      </div>

      <!-- Connect Links Section -->
      <div
        class="links-section border border-[var(--border-color)] border-t-0 p-4 sm:p-6"
      >
        <div class="flex items-center gap-3 mb-4">
          <Badge size="xs">
            <span class="whitespace-nowrap text-xs uppercase">Connect</span>
          </Badge>
          <div class="flex-1 h-px bg-[var(--border-color)]"></div>
        </div>

        <div class="flex flex-col gap-3">
          <a
            href={socials.github}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon"><GitHub /></span>
            <span class="link-text">GitHub</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href={socials.linkedIn}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon"><LinkedIn /></span>
            <span class="link-text">LinkedIn</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href={socials.twitter}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon"><Twitter /></span>
            <span class="link-text">Twitter / X</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href={socials.instagram}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon"><Instagram /></span>
            <span class="link-text">Instagram</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href={socials.discord}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group"
          >
            <span class="link-icon"><Discord /></span>
            <span class="link-text">Discord</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a href={socials.mail} class="link-button group">
            <span class="link-icon"><Mail /></span>
            <span class="link-text">Email Me</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>
        </div>
      </div>

      <!-- Promotions Section -->
      <div
        class="links-section border border-[var(--border-color)] border-t-0 p-4 sm:p-6"
      >
        <div class="flex items-center gap-3 mb-4">
          <Badge size="xs">
            <span class="whitespace-nowrap text-xs uppercase"
              >Projects & Promotions</span
            >
          </Badge>
          <div class="flex-1 h-px bg-[var(--border-color)]"></div>
        </div>

        <div class="flex flex-col gap-3">
          <a
            href={dialoghUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group promo"
          >
            <span class="link-icon">
              <Favicon url={dialoghUrl} />
            </span>
            <span class="link-text">Join Dialogh</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href="https://interacly.com"
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group promo"
          >
            <span class="link-icon">
              <Favicon url="https://interacly.com/" />
            </span>
            <span class="link-text">Try Interacly</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>

          <a
            href="https://lito.rohitk06.in/introduction/"
            target="_blank"
            rel="noopener noreferrer"
            class="link-button group promo"
          >
            <span class="link-icon">
              <Favicon url="https://lito.rohitk06.in/" />
            </span>
            <span class="link-text">Try Lito</span>
            <span class="link-arrow group-hover:translate-x-1">→</span>
          </a>
        </div>
      </div>

      <!-- Footer -->
      <div
        class="footer-section border border-[var(--border-color)] border-t-0 p-4 text-center"
      >
        <p class="text-[var(--text-secondary)] text-sm">
          &copy; {new Date().getFullYear()} Rohit Kushwaha
        </p>
      </div>
    </div>

    <!-- Theme changer -->
    <div class="sticky bottom-8 right-8 z-50">
      <div class="flex justify-end sm:pr-8 pr-5">
        <ThemeChanger client:only="svelte" />
      </div>
    </div>
  </div>

  <style>
    .page-content {
      min-height: 100vh;
    }

    /* Profile Avatar */
    .profile-avatar {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    /* Link Button Styles */
    .link-button {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.875rem 1rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      text-decoration: none;
      color: var(--text-primary);
    }

    .link-button:hover {
      border-color: var(--accent-primary);
    }

    .link-button:hover .link-icon,
    .link-button:hover .link-text {
      color: var(--accent-primary);
    }

    .link-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      color: var(--text-secondary);
    }

    .link-text {
      flex: 1;
      font-weight: 500;
      font-size: 0.95rem;
    }

    .link-arrow {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .link-button:hover .link-arrow {
      color: var(--accent-primary);
    }

    /* Promo Links */
    .link-button.promo {
      border-color: var(--accent-primary);
      border-style: dashed;
    }

    /* Responsive */
    @media (max-width: 480px) {
      .link-button {
        padding: 0.75rem 0.875rem;
      }

      .link-text {
        font-size: 0.875rem;
      }
    }
  </style>

  <script>
    import { gsap } from "gsap";

    document.addEventListener("DOMContentLoaded", () => {
      // Animate sections
      gsap.from(".banner-section", {
        opacity: 0,
        y: 20,
        duration: 0.6,
        ease: "power3.out",
      });

      gsap.from(".profile-section", {
        opacity: 0,
        y: 20,
        duration: 0.6,
        delay: 0.1,
        ease: "power3.out",
      });

      gsap.from(".discord-section", {
        opacity: 0,
        y: 20,
        duration: 0.5,
        delay: 0.2,
        ease: "power3.out",
      });

      gsap.from(".links-section", {
        opacity: 0,
        y: 20,
        duration: 0.5,
        stagger: 0.1,
        delay: 0.3,
        ease: "power3.out",
      });

      gsap.from(".share-section", {
        opacity: 0,
        y: 20,
        duration: 0.5,
        delay: 0.5,
        ease: "power3.out",
      });

      gsap.from(".link-button", {
        opacity: 0,
        x: -10,
        duration: 0.4,
        stagger: 0.05,
        delay: 0.4,
        ease: "power2.out",
      });
    });

    // Copy link functionality
    document
      .getElementById("copyLinkBtn")
      ?.addEventListener("click", async function () {
        const url = this.getAttribute("data-url") || window.location.href;
        try {
          await navigator.clipboard.writeText(url);
          this.classList.add("copied");
          const span = this.querySelector("span");
          if (span) span.textContent = "Copied!";
          setTimeout(() => {
            this.classList.remove("copied");
            if (span) span.textContent = "Copy Link";
          }, 2000);
        } catch (err) {
          console.error("Failed to copy:", err);
        }
      });

    // Native share functionality
    document
      .getElementById("shareBtn")
      ?.addEventListener("click", async function () {
        const url = this.getAttribute("data-url") || window.location.href;
        const title =
          this.getAttribute("data-title") || "Rohit Kushwaha - Socials";

        if (navigator.share) {
          try {
            await navigator.share({ title, url });
          } catch (err) {
            if ((err as Error).name !== "AbortError") {
              console.error("Share failed:", err);
            }
          }
        } else {
          // Fallback: copy to clipboard
          try {
            await navigator.clipboard.writeText(url);
            const span = this.querySelector("span");
            if (span) span.textContent = "Link Copied!";
            setTimeout(() => {
              if (span) span.textContent = "Share";
            }, 2000);
          } catch (err) {
            console.error("Fallback copy failed:", err);
          }
        }
      });
  </script>
</Layout>
